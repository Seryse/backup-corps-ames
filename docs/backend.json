{
  "entities": {
    "Formation": {
      "title": "Formation",
      "type": "object",
      "description": "Represents a training course or program offered.",
      "properties": {
        "name": {
          "type": "object",
          "description": "Localized name of the formation.",
          "properties": {
            "en": { "type": "string" },
            "fr": { "type": "string" },
            "es": { "type": "string" }
          },
          "required": ["en", "fr", "es"]
        },
        "description": {
          "type": "object",
          "description": "Localized detailed description of the formation.",
          "properties": {
            "en": { "type": "string" },
            "fr": { "type": "string" },
            "es": { "type": "string" }
          },
          "required": ["en", "fr", "es"]
        },
        "tokenProductId": {
          "type": "string",
          "description": "Identifier for the access token product."
        },
        "price": {
          "type": "number",
          "description": "Price of the formation in the smallest currency unit (e.g., cents)."
        },
        "currency": {
          "type": "string",
          "description": "Currency for the price (e.g., eur, usd)."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the formation's image, hosted on Firebase Storage.",
          "format": "uri"
        }
      },
      "required": [
        "name",
        "description",
        "tokenProductId",
        "price",
        "currency",
        "imageUrl"
      ]
    },
    "UserFormation": {
      "title": "UserFormation",
      "type": "object",
      "description": "Represents a user's enrollment in a specific formation and their access token.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N UserFormation)"
        },
        "formationId": {
          "type": "string",
          "description": "Reference to Formation. (Relationship: Formation 1:N UserFormation)"
        },
        "accessToken": {
          "type": "string",
          "description": "Token granting access to the dedicated hub/content for the formation."
        },
        "enrollmentDate": {
          "type": "string",
          "description": "Date when the user enrolled in the formation.",
          "format": "date-time"
        }
      },
      "required": [
        "userId",
        "formationId",
        "accessToken",
        "enrollmentDate"
      ]
    },
    "NewsArticle": {
      "title": "News Article",
      "type": "object",
      "description": "Represents a single news article or blog post.",
      "properties": {
        "title": {
          "type": "object",
          "description": "Localized title of the article.",
          "properties": {
            "en": { "type": "string" },
            "fr": { "type": "string" },
            "es": { "type": "string" }
          },
          "required": ["en", "fr", "es"]
        },
        "content": {
          "type": "object",
          "description": "Localized content of the article.",
          "properties": {
            "en": { "type": "string" },
            "fr": { "type": "string" },
            "es": { "type": "string" }
          },
          "required": ["en", "fr", "es"]
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the article's image, hosted on Firebase Storage.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "Date when the article was created.",
          "format": "date-time"
        }
      },
      "required": ["title", "content", "imageUrl", "createdAt"]
    },
    "Subtitle": {
      "title": "Subtitle",
      "type": "object",
      "description": "Represents a single subtitle entry with its translation for a live session.",
      "properties": {
        "original": {
          "type": "string",
          "description": "The original text captured from speech."
        },
        "translated": {
          "type": "string",
          "description": "The translated text in the target language."
        },
        "timestamp": {
          "type": "number",
          "description": "The timestamp when the subtitle was generated."
        }
      },
      "required": ["original", "translated", "timestamp"]
    },
    "SessionType": {
      "title": "Session Type",
      "type": "object",
      "description": "Represents a type of session that can be booked.",
      "properties": {
        "name": {
          "type": "object",
          "description": "Localized name of the session type.",
          "properties": {
            "en": { "type": "string" },
            "fr": { "type": "string" },
            "es": { "type": "string" }
          },
          "required": ["en", "fr", "es"]
        },
        "description": {
          "type": "object",
          "description": "Localized description of the session type.",
          "properties": {
            "en": { "type": "string" },
            "fr": { "type": "string" },
            "es": { "type": "string" }
          },
          "required": ["en", "fr", "es"]
        },
        "sessionModel": {
          "type": "string",
          "enum": ["private", "small_group", "large_group"],
          "description": "Defines the capacity of the session."
        },
        "maxParticipants": {
          "type": "number",
          "description": "Maximum number of participants. 1 for private, up to 5 for small_group, etc."
        },
        "price": {
          "type": "number",
          "description": "Price in smallest currency unit."
        },
        "currency": {
          "type": "string",
          "description": "Currency code (e.g., eur)."
        },
        "tokenProductId": {
          "type": "string",
          "description": "Identifier for the access token product for this session type."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the session type's image, hosted on Firebase Storage.",
          "format": "uri"
        }
      },
      "required": ["name", "description", "sessionModel", "maxParticipants", "price", "currency", "tokenProductId"]
    },
    "TimeSlot": {
      "title": "Time Slot",
      "type": "object",
      "description": "Represents an available time slot for a session.",
      "properties": {
        "sessionTypeId": {
          "type": "string",
          "description": "Reference to SessionType."
        },
        "startTime": {
          "type": "string",
          "format": "date-time",
          "description": "The start time of the session."
        },
        "endTime": {
          "type": "string",
          "format": "date-time",
          "description": "The end time of the session."
        },
        "bookedParticipantsCount": {
          "type": "number",
          "description": "Number of participants already booked for this slot."
        }
      },
      "required": ["sessionTypeId", "startTime", "endTime", "bookedParticipantsCount"]
    },
    "Booking": {
      "title": "Booking",
      "type": "object",
      "description": "Represents a user's booking for a specific time slot.",
      "properties": {
        "userId": { "type": "string" },
        "timeSlotId": { "type": "string" },
        "sessionTypeId": { "type": "string" },
        "bookingTime": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["confirmed", "pending", "cancelled"] },
        "visioToken": {
          "type": "string",
          "description": "The unique token granting access to the live video session for this booking."
        }
      },
      "required": ["userId", "timeSlotId", "sessionTypeId", "bookingTime", "status", "visioToken"]
    },
    "LiveSession": {
      "title": "Live Session State",
      "type": "object",
      "description": "Stores the real-time state of a live video session.",
      "properties": {
        "hostId": {
          "type": "string",
          "description": "The UID of the host (praticien)."
        },
        "bookingId": {
          "type": "string",
          "description": "Reference to the booking document."
        },
        "triggerIntro": {
          "type": "boolean",
          "description": "A flag set by the admin to trigger the intro audio on the client side."
        },
        "activePlaylistUrl": {
          "type": "string",
          "description": "URL of the background music playlist currently being played by the admin."
        },
        "subtitle": {
          "$ref": "#/entities/Subtitle"
        }
      },
      "required": ["hostId", "bookingId"]
    },
    "Testimonial": {
      "title": "Testimonial",
      "type": "object",
      "description": "User feedback provided after a session.",
      "properties": {
        "userId": { "type": "string" },
        "bookingId": { "type": "string" },
        "submittedAt": { "type": "string", "format": "date-time" },
        "feedbackText": { "type": "string" },
        "mediaUrl": { "type": "string", "format": "uri" },
        "mediaType": { "type": "string", "enum": ["audio", "video"] }
      },
      "required": ["userId", "bookingId", "submittedAt"]
    },
    "Coupon": {
      "title": "Coupon",
      "type": "object",
      "description": "A promotional coupon code.",
      "properties": {
        "code": { "type": "string" },
        "userId": { "type": "string" },
        "discountPercentage": { "type": "number" },
        "createdAt": { "type": "string", "format": "date-time" },
        "isUsed": { "type": "boolean" }
      },
      "required": ["code", "userId", "discountPercentage", "createdAt", "isUsed"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com"
    ]
  },
  "firestore": {
    "/formations/{formationId}": {
      "schema": {
        "$ref": "#/entities/Formation"
      },
      "description": "Stores information about each formation. 'formationId' is the unique identifier for the formation."
    },
    "/users/{userId}/formations/{userFormationId}": {
      "schema": {
        "$ref": "#/entities/UserFormation"
      },
      "description": "Represents a user's enrollment in a specific formation and their access token. This subcollection uses path-based ownership for simplified security rules."
    },
    "/news/{newsId}": {
      "schema": {
        "$ref": "#/entities/NewsArticle"
      },
      "description": "Stores all news articles."
    },
    "/subtitles/{sessionId}": {
      "schema": {
        "$ref": "#/entities/Subtitle"
      },
      "description": "[DEPRECATED] Stores the current subtitle for a live session. This is now part of the /sessions/{sessionId} document."
    },
    "/sessionTypes/{sessionTypeId}": {
      "schema": { "$ref": "#/entities/SessionType" },
      "description": "Stores all available types of sessions."
    },
    "/timeSlots/{timeSlotId}": {
      "schema": { "$ref": "#/entities/TimeSlot" },
      "description": "Stores all available time slots for all sessions."
    },
    "/users/{userId}/bookings/{bookingId}": {
      "schema": { "$ref": "#/entities/Booking" },
      "description": "Stores a user's session bookings."
    },
    "/sessions/{sessionId}": {
      "schema": {
        "$ref": "#/entities/LiveSession"
      },
      "description": "Stores the real-time state for a specific live session. The sessionId is typically the bookingId."
    },
    "/testimonials/{testimonialId}": {
      "schema": {
        "$ref": "#/entities/Testimonial"
      },
      "description": "Stores user testimonials submitted after sessions."
    },
    "/coupons/{couponId}": {
      "schema": {
        "$ref": "#/entities/Coupon"
      },
      "description": "Stores generated coupon codes for users."
    }
  }
}
